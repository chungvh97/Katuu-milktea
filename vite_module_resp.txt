
        <!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="UTF-8" />
            <title>Error</title>
            <script type="module">
              const error = {"message":"C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\components\\AdminPanel.tsx: Unexpected reserved word 'await'. (435:18)\n\n  433 |       const headers: any = { 'Content-Type': 'application/json' };\n  434 |       if (authToken) headers.Authorization = `Bearer ${authToken}`;\n> 435 |       const res = await fetch(`${API_BASE}/api/categories`, { method: 'POST', headers, body: JSON.stringify(categoryForm) });\n      |                   ^\n  436 |       if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Thêm danh mục thất bại'); return; }\n  437 |       const newCategory = await res.json();\n  438 |       const updated = [...localCategories, newCategory];","stack":"    at constructor (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:367:19)\n    at TypeScriptParserMixin.raise (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:6624:19)\n    at TypeScriptParserMixin.checkReservedWord (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12305:12)\n    at TypeScriptParserMixin.checkReservedWord (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:9369:13)\n    at TypeScriptParserMixin.parseIdentifierName (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12285:12)\n    at TypeScriptParserMixin.parseIdentifier (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12255:23)\n    at TypeScriptParserMixin.parseExprAtom (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11482:27)\n    at TypeScriptParserMixin.parseExprAtom (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:4793:20)\n    at TypeScriptParserMixin.parseExprSubscripts (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11145:23)\n    at TypeScriptParserMixin.parseUpdate (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11130:21)\n    at TypeScriptParserMixin.parseMaybeUnary (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11110:23)\n    at TypeScriptParserMixin.parseMaybeUnary (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:9890:18)\n    at TypeScriptParserMixin.parseMaybeUnaryOrPrivate (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10963:61)\n    at TypeScriptParserMixin.parseExprOps (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10968:23)\n    at TypeScriptParserMixin.parseMaybeConditional (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10945:23)\n    at TypeScriptParserMixin.parseMaybeAssign (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10895:21)\n    at TypeScriptParserMixin.parseMaybeAssign (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:9839:20)\n    at C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10864:39\n    at TypeScriptParserMixin.allowInAnd (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12495:16)\n    at TypeScriptParserMixin.parseMaybeAssignAllowIn (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10864:17)\n    at TypeScriptParserMixin.parseVar (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13460:91)\n    at TypeScriptParserMixin.parseVarStatement (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13306:10)\n    at TypeScriptParserMixin.parseVarStatement (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:9469:31)\n    at TypeScriptParserMixin.parseStatementContent (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12927:23)\n    at TypeScriptParserMixin.parseStatementContent (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:9569:18)\n    at TypeScriptParserMixin.parseStatementLike (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12843:17)\n    at TypeScriptParserMixin.parseStatementListItem (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12823:17)\n    at TypeScriptParserMixin.parseBlockOrModuleBlockBody (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13392:61)\n    at TypeScriptParserMixin.parseBlockBody (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13385:10)\n    at TypeScriptParserMixin.parseBlock (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13373:10)\n    at TypeScriptParserMixin.parseTryStatement (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13281:23)\n    at TypeScriptParserMixin.parseStatementContent (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12880:21)\n    at TypeScriptParserMixin.parseStatementContent (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:9569:18)\n    at TypeScriptParserMixin.parseStatementLike (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12843:17)\n    at TypeScriptParserMixin.parseStatementListItem (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12823:17)\n    at TypeScriptParserMixin.parseBlockOrModuleBlockBody (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13392:61)\n    at TypeScriptParserMixin.parseBlockBody (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13385:10)\n    at TypeScriptParserMixin.parseBlock (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:13373:10)\n    at TypeScriptParserMixin.parseFunctionBody (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12174:24)\n    at TypeScriptParserMixin.parseArrowExpression (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:12149:10)\n    at TypeScriptParserMixin.parseParenAndDistinguishExpression (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11759:12)\n    at TypeScriptParserMixin.parseExprAtom (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11395:23)\n    at TypeScriptParserMixin.parseExprAtom (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:4793:20)\n    at TypeScriptParserMixin.parseExprSubscripts (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11145:23)\n    at TypeScriptParserMixin.parseUpdate (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11130:21)\n    at TypeScriptParserMixin.parseMaybeUnary (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:11110:23)\n    at TypeScriptParserMixin.parseMaybeUnary (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:9890:18)\n    at TypeScriptParserMixin.parseMaybeUnaryOrPrivate (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10963:61)\n    at TypeScriptParserMixin.parseExprOps (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10968:23)\n    at TypeScriptParserMixin.parseMaybeConditional (C:\\Users\\ChungVH\\Downloads\\katuu---milk-tea-ordering\\node_modules\\@babel\\parser\\lib\\index.js:10945:23)","id":"C:/Users/ChungVH/Downloads/katuu---milk-tea-ordering/components/AdminPanel.tsx","frame":"438|        const updated = [...localCategories, newCategory];\n439|        setLocalCategories(updated);\n440|        try { addAudit({ action: 'create', target: 'category', targetId: newCategory.id, before: null, after: newCategory, note: 'Thêm danh mục' }); } catch (e) {}\n   |                                                               ^\n441|        try { onUpdateCategories(updated); } catch (e) {}\n442|        resetForms();","plugin":"vite:react-babel","pluginCode":"import React, { useState, useEffect } from 'react';\r\nimport type { Product, Topping, Size, Category } from '../types';\r\nimport {\r\n  ArrowLeftIcon,\r\n  PlusIcon,\r\n  EditIcon,\r\n  TrashIcon,\r\n  SaveIcon,\r\n  XIcon,\r\n  PackageIcon,\r\n  ToppingIcon,\r\n  SizeIcon,\r\n  TagIcon,\r\n  ImageIcon,\r\n  WarningIcon\r\n} from '../assets/icons';\r\nimport { formatVND } from '../utils/formatting';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport LoginPage from './LoginPage';\r\nimport { useAudit } from '../contexts/AuditContext';\r\n\r\ninterface AdminPanelProps {\r\n  onBack: () => void;\r\n  products: Product[];\r\n  toppings: Topping[];\r\n  sizes: Size[];\r\n  categories: Category[];\r\n  onUpdateProducts: (products: Product[]) => void;\r\n  onUpdateToppings: (toppings: Topping[]) => void;\r\n  onUpdateSizes: (sizes: Size[]) => void;\r\n  onUpdateCategories: (categories: Category[]) => void;\r\n}\r\n\r\ntype TabType = 'products' | 'toppings' | 'sizes' | 'categories' | 'audit';\r\n\r\ninterface ProductFormData {\r\n  id: number;\r\n  name: string;\r\n  price: number;\r\n  image: string;\r\n  category: string;\r\n}\r\n\r\ninterface ToppingFormData {\r\n  id: number;\r\n  name: string;\r\n  price: number;\r\n}\r\n\r\ninterface SizeFormData {\r\n  id: number;\r\n  name: string;\r\n  priceModifier: number;\r\n}\r\n\r\ninterface CategoryFormData {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\nconst AdminPanel: React.FC\u003cAdminPanelProps> = ({\r\n  onBack,\r\n  products,\r\n  toppings,\r\n  sizes,\r\n  categories,\r\n  onUpdateProducts,\r\n  onUpdateToppings,\r\n  onUpdateSizes,\r\n  onUpdateCategories,\r\n}) => {\r\n  const { isAuthenticated, user, logout, isAdmin } = useAuth();\r\n  const { audits, addAudit, clearAudits } = useAudit();\r\n  const API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:4000';\r\n  const authToken = typeof window !== 'undefined' ? localStorage.getItem('authToken') || '' : '';\r\n\r\n  // Local state backed by server (fallback to props)\r\n  const [localProducts, setLocalProducts] = useState\u003cProduct[]>(products);\r\n  const [localToppings, setLocalToppings] = useState\u003cTopping[]>(toppings);\r\n  const [localSizes, setLocalSizes] = useState\u003cSize[]>(sizes);\r\n  const [localCategories, setLocalCategories] = useState\u003cCategory[]>(categories);\r\n\r\n  // Load server data on mount\r\n  useEffect(() => {\r\n    const fetchAll = async () => {\r\n      try {\r\n        const headers: any = { 'Content-Type': 'application/json' };\r\n        if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n\r\n        const [pRes, tRes, sRes, cRes] = await Promise.all([\r\n          fetch(`${API_BASE}/api/products`, { headers }),\r\n          fetch(`${API_BASE}/api/toppings`, { headers }),\r\n          fetch(`${API_BASE}/api/sizes`, { headers }),\r\n          fetch(`${API_BASE}/api/categories`, { headers }),\r\n        ]);\r\n\r\n        if (pRes.ok) setLocalProducts(await pRes.json());\r\n        if (tRes.ok) setLocalToppings(await tRes.json());\r\n        if (sRes.ok) setLocalSizes(await sRes.json());\r\n        if (cRes.ok) setLocalCategories(await cRes.json());\r\n      } catch (e) {\r\n        // server unreachable - keep using provided props\r\n        console.warn('Could not load admin data from server, using local props', e);\r\n      }\r\n    };\r\n    fetchAll();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const [activeTab, setActiveTab] = useState\u003cTabType>('products');\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editingId, setEditingId] = useState\u003cnumber | string | null>(null);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const [deleteId, setDeleteId] = useState\u003cnumber | string | null>(null);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n\r\n  // Form states\r\n  const [productForm, setProductForm] = useState\u003cProductFormData>({\r\n    id: 0,\r\n    name: '',\r\n    price: 0,\r\n    image: '',\r\n    category: categories[0]?.id || 'milk-tea',\r\n  });\r\n\r\n  const [toppingForm, setToppingForm] = useState\u003cToppingFormData>({\r\n    id: 0,\r\n    name: '',\r\n    price: 0,\r\n  });\r\n\r\n  const [sizeForm, setSizeForm] = useState\u003cSizeFormData>({\r\n    id: 0,\r\n    name: '',\r\n    priceModifier: 0,\r\n  });\r\n\r\n  const [categoryForm, setCategoryForm] = useState\u003cCategoryFormData>({\r\n    id: '',\r\n    name: '',\r\n  });\r\n\r\n  // Validation & permission helpers\r\n  const [productErrors, setProductErrors] = useState\u003cRecord\u003cstring,string>>({});\r\n  const [toppingErrors, setToppingErrors] = useState\u003cRecord\u003cstring,string>>({});\r\n  const [sizeErrors, setSizeErrors] = useState\u003cRecord\u003cstring,string>>({});\r\n  const [categoryErrors, setCategoryErrors] = useState\u003cRecord\u003cstring,string>>({});\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n\r\n  const showError = (msg: string) => {\r\n    setErrorMessage(msg);\r\n    setTimeout(() => setErrorMessage(''), 3500);\r\n  };\r\n\r\n  const validateProductForm = () => {\r\n    const errs: Record\u003cstring,string> = {};\r\n    if (!productForm.name || !productForm.name.trim()) errs.name = 'Tên sản phẩm không được để trống.';\r\n    if (productForm.price == null || Number(productForm.price) \u003c= 0) errs.price = 'Giá phải lớn hơn 0.';\r\n    if (!localCategories.find(c => c.id === productForm.category)) errs.category = 'Chọn danh mục hợp lệ.';\r\n    if (productForm.image) {\r\n      try { new URL(productForm.image); } catch { errs.image = 'URL hình ảnh không hợp lệ.'; }\r\n    }\r\n    const duplicate = localProducts.some(p => p.name.trim().toLowerCase() === productForm.name.trim().toLowerCase() && p.id !== (isEditing ? editingId : 0));\r\n    if (duplicate) errs.name = 'Tên sản phẩm đã tồn tại.';\r\n    setProductErrors(errs);\r\n    return errs;\r\n  };\r\n\r\n  const validateToppingForm = () => {\r\n    const errs: Record\u003cstring,string> = {};\r\n    if (!toppingForm.name || !toppingForm.name.trim()) errs.name = 'Tên topping không được để trống.';\r\n    if (toppingForm.price == null || Number(toppingForm.price) \u003c 0) errs.price = 'Giá phải là số không âm.';\r\n    const duplicate = localToppings.some(t => t.name.trim().toLowerCase() === toppingForm.name.trim().toLowerCase() && t.id !== (isEditing ? editingId : 0));\r\n    if (duplicate) errs.name = 'Topping đã tồn tại.';\r\n    setToppingErrors(errs);\r\n    return errs;\r\n  };\r\n\r\n  const validateSizeForm = () => {\r\n    const errs: Record\u003cstring,string> = {};\r\n    if (!sizeForm.name || !sizeForm.name.trim()) errs.name = 'Tên size không được để trống.';\r\n    if (sizeForm.priceModifier == null || Number(sizeForm.priceModifier) \u003c 0) errs.priceModifier = 'Giá thêm phải là số không âm.';\r\n    const duplicate = localSizes.some(s => s.name.trim().toLowerCase() === sizeForm.name.trim().toLowerCase() && s.id !== (isEditing ? editingId : 0));\r\n    if (duplicate) errs.name = 'Size đã tồn tại.';\r\n    setSizeErrors(errs);\r\n    return errs;\r\n  };\r\n\r\n  const validateCategoryForm = () => {\r\n    const errs: Record\u003cstring,string> = {};\r\n    if (!categoryForm.id || !categoryForm.id.trim()) errs.id = 'ID danh mục không được để trống.';\r\n    if (!/^[a-z0-9\\-]+$/.test(categoryForm.id)) errs.id = 'ID chỉ được chứa chữ thường, số và dấu gạch ngang.';\r\n    if (!categoryForm.name || !categoryForm.name.trim()) errs.name = 'Tên danh mục không được để trống.';\r\n    const duplicate = localCategories.some(c => c.id === categoryForm.id && c.id !== (isEditing ? String(editingId) : ''));\r\n    if (duplicate) errs.id = 'ID danh mục đã tồn tại.';\r\n    setCategoryErrors(errs);\r\n    return errs;\r\n  };\r\n\r\n  const showSuccess = (message: string) => {\r\n    setSuccessMessage(message);\r\n    setTimeout(() => setSuccessMessage(''), 3000);\r\n  };\r\n\r\n  const resetForms = () => {\r\n    setProductForm({\r\n      id: 0,\r\n      name: '',\r\n      price: 0,\r\n      image: '',\r\n      category: categories[0]?.id || 'milk-tea',\r\n    });\r\n    setToppingForm({ id: 0, name: '', price: 0 });\r\n    setSizeForm({ id: 0, name: '', priceModifier: 0 });\r\n    setCategoryForm({ id: '', name: '' });\r\n    setIsEditing(false);\r\n    setEditingId(null);\r\n  };\r\n\r\n  // Product handlers\r\n  const handleAddProduct = async () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateProductForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    try {\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const body = { name: productForm.name, price: productForm.price, image: productForm.image, category: productForm.category };\r\n      const res = await fetch(`${API_BASE}/api/products`, { method: 'POST', headers, body: JSON.stringify(body) });\r\n      if (!res.ok) {\r\n        const err = await res.json().catch(() => ({}));\r\n        showError(err.error || 'Thêm sản phẩm thất bại');\r\n        return;\r\n      }\r\n      const newProduct = await res.json();\r\n      const updated = [...localProducts, newProduct];\r\n      setLocalProducts(updated);\r\n      try { addAudit({ action: 'create', target: 'product', targetId: newProduct.id, before: null, after: newProduct, note: 'Thêm sản phẩm' }); } catch (e) {}\r\n      // keep parent in sync\r\n      try { onUpdateProducts(updated); } catch (e) {}\r\n      resetForms();\r\n      showSuccess('Đã thêm sản phẩm thành công!');\r\n    } catch (e) {\r\n      console.error(e);\r\n      showError('Không thể kết nối tới server');\r\n    }\r\n  };\r\n\r\n  const handleEditProduct = (product: Product) => {\r\n    setProductForm(product);\r\n    setIsEditing(true);\r\n    setEditingId(product.id);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  };\r\n\r\n  const handleUpdateProduct = async () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateProductForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    try {\r\n      const id = editingId as number;\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/products/${id}`, { method: 'PUT', headers, body: JSON.stringify(productForm) });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Cập nhật thất bại'); return; }\r\n      const updatedProduct = await res.json();\r\n      const updated = localProducts.map(p => p.id === updatedProduct.id ? updatedProduct : p);\r\n      setLocalProducts(updated);\r\n      try { addAudit({ action: 'update', target: 'product', targetId: updatedProduct.id, before: null, after: updatedProduct, note: 'Cập nhật sản phẩm' }); } catch (e) {}\r\n      try { onUpdateProducts(updated); } catch (e) {}\r\n      resetForms();\r\n      showSuccess('Đã cập nhật sản phẩm thành công!');\r\n    } catch (e) {\r\n      console.error(e);\r\n      showError('Không thể kết nối tới server');\r\n    }\r\n  };\r\n\r\n  const handleDeleteProduct = async (id: number) => {\r\n    try {\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/products/${id}`, { method: 'DELETE', headers });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Xóa thất bại'); return; }\r\n      const updated = localProducts.filter(p => p.id !== id);\r\n      setLocalProducts(updated);\r\n      try { addAudit({ action: 'delete', target: 'product', targetId: id, before: null, after: null, note: 'Xóa sản phẩm' }); } catch (e) {}\r\n      try { onUpdateProducts(updated); } catch (e) {}\r\n      setShowDeleteConfirm(false); setDeleteId(null);\r\n      showSuccess('Đã xóa sản phẩm thành công!');\r\n    } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n  };\r\n\r\n  // Topping handlers\r\n  const handleAddTopping = async () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateToppingForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    try {\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/toppings`, { method: 'POST', headers, body: JSON.stringify(toppingForm) });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Thêm topping thất bại'); return; }\r\n      const newTopping = await res.json();\r\n      const updated = [...localToppings, newTopping];\r\n      setLocalToppings(updated);\r\n      try { addAudit({ action: 'create', target: 'topping', targetId: newTopping.id, before: null, after: newTopping, note: 'Thêm topping' }); } catch (e) {}\r\n      try { onUpdateToppings(updated); } catch (e) {}\r\n      resetForms();\r\n      showSuccess('Đã thêm topping thành công!');\r\n    } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n  };\r\n\r\n  const handleEditTopping = (topping: Topping) => {\r\n    setToppingForm(topping);\r\n    setIsEditing(true);\r\n    setEditingId(topping.id);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  };\r\n\r\n  const handleUpdateTopping = async () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateToppingForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    try {\r\n      const id = editingId as number;\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/toppings/${id}`, { method: 'PUT', headers, body: JSON.stringify(toppingForm) });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Cập nhật thất bại'); return; }\r\n      const updatedTopping = await res.json();\r\n      const updated = localToppings.map(t => t.id === updatedTopping.id ? updatedTopping : t);\r\n      setLocalToppings(updated);\r\n      try { addAudit({ action: 'update', target: 'topping', targetId: updatedTopping.id, before: null, after: updatedTopping, note: 'Cập nhật topping' }); } catch (e) {}\r\n      try { onUpdateToppings(updated); } catch (e) {}\r\n      resetForms();\r\n      showSuccess('Đã cập nhật topping thành công!');\r\n    } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n  };\r\n\r\n  const handleDeleteTopping = async (id: number) => {\r\n    try {\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/toppings/${id}`, { method: 'DELETE', headers });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Xóa thất bại'); return; }\r\n      const updated = localToppings.filter(t => t.id !== id);\r\n      setLocalToppings(updated);\r\n      try { addAudit({ action: 'delete', target: 'topping', targetId: id, before: null, after: null, note: 'Xóa topping' }); } catch (e) {}\r\n      try { onUpdateToppings(updated); } catch (e) {}\r\n      setShowDeleteConfirm(false); setDeleteId(null);\r\n      showSuccess('Đã xóa topping thành công!');\r\n    } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n  };\r\n\r\n  // Size handlers\r\n  const handleAddSize = () => {\r\n    // Server-backed add size\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateSizeForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    (async () => {\r\n      try {\r\n        const headers: any = { 'Content-Type': 'application/json' };\r\n        if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n        const res = await fetch(`${API_BASE}/api/sizes`, { method: 'POST', headers, body: JSON.stringify(sizeForm) });\r\n        if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Thêm size thất bại'); return; }\r\n        const newSize = await res.json();\r\n        const updated = [...localSizes, newSize];\r\n        setLocalSizes(updated);\r\n        try { addAudit({ action: 'create', target: 'size', targetId: newSize.id, before: null, after: newSize, note: 'Thêm size' }); } catch (e) {}\r\n        try { onUpdateSizes(updated); } catch (e) {}\r\n        resetForms();\r\n        showSuccess('Đã thêm size thành công!');\r\n      } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n    })();\r\n  };\r\n\r\n  const handleEditSize = (size: Size) => {\r\n    setSizeForm(size);\r\n    setIsEditing(true);\r\n    setEditingId(size.id);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  };\r\n\r\n  const handleUpdateSize = () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateSizeForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    (async () => {\r\n      try {\r\n        const id = editingId as number;\r\n        const headers: any = { 'Content-Type': 'application/json' };\r\n        if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n        const res = await fetch(`${API_BASE}/api/sizes/${id}`, { method: 'PUT', headers, body: JSON.stringify(sizeForm) });\r\n        if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Cập nhật size thất bại'); return; }\r\n        const updatedSize = await res.json();\r\n        const updated = localSizes.map(s => s.id === updatedSize.id ? updatedSize : s);\r\n        setLocalSizes(updated);\r\n        try { addAudit({ action: 'update', target: 'size', targetId: updatedSize.id, before: null, after: updatedSize, note: 'Cập nhật size' }); } catch (e) {}\r\n        try { onUpdateSizes(updated); } catch (e) {}\r\n        resetForms();\r\n        showSuccess('Đã cập nhật size thành công!');\r\n      } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n    })();\r\n  };\r\n\r\n  const handleDeleteSize = (id: number) => {\r\n    (async () => {\r\n      if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); setShowDeleteConfirm(false); setDeleteId(null); return; }\r\n      try {\r\n        const headers: any = { 'Content-Type': 'application/json' };\r\n        if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n        const res = await fetch(`${API_BASE}/api/sizes/${id}`, { method: 'DELETE', headers });\r\n        if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Xóa size thất bại'); return; }\r\n        const updated = localSizes.filter(s => s.id !== id);\r\n        setLocalSizes(updated);\r\n        try { addAudit({ action: 'delete', target: 'size', targetId: id, before: null, after: null, note: 'Xóa size' }); } catch (e) {}\r\n        try { onUpdateSizes(updated); } catch (e) {}\r\n        setShowDeleteConfirm(false); setDeleteId(null);\r\n        showSuccess('Đã xóa size thành công!');\r\n      } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n    })();\r\n  };\r\n\r\n  // Category handlers\r\n  const handleAddCategory = () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateCategoryForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    // server-backed add category\r\n    try {\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/categories`, { method: 'POST', headers, body: JSON.stringify(categoryForm) });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Thêm danh mục thất bại'); return; }\r\n      const newCategory = await res.json();\r\n      const updated = [...localCategories, newCategory];\r\n      setLocalCategories(updated);\r\n      try { addAudit({ action: 'create', target: 'category', targetId: newCategory.id, before: null, after: newCategory, note: 'Thêm danh mục' }); } catch (e) {}\r\n      try { onUpdateCategories(updated); } catch (e) {}\r\n      resetForms();\r\n      showSuccess('Đã thêm danh mục thành công!');\r\n    } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n  };\r\n\r\n  const handleEditCategory = (category: Category) => {\r\n    setCategoryForm(category);\r\n    setIsEditing(true);\r\n    setEditingId(category.id);\r\n    window.scrollTo({ top: 0, behavior: 'smooth' });\r\n  };\r\n\r\n  const handleUpdateCategory = async () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền thực hiện hành động này.'); return; }\r\n    const errs = validateCategoryForm();\r\n    if (Object.keys(errs).length > 0) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }\r\n    try {\r\n      const id = String(editingId);\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/categories/${encodeURIComponent(id)}`, { method: 'PUT', headers, body: JSON.stringify(categoryForm) });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Cập nhật danh mục thất bại'); return; }\r\n      const updatedCategory = await res.json();\r\n      const updated = localCategories.map(c => c.id === updatedCategory.id ? updatedCategory : c);\r\n      setLocalCategories(updated);\r\n      try { addAudit({ action: 'update', target: 'category', targetId: updatedCategory.id, before: null, after: updatedCategory, note: 'Cập nhật danh mục' }); } catch (e) {}\r\n      try { onUpdateCategories(updated); } catch (e) {}\r\n      resetForms();\r\n      showSuccess('Đã cập nhật danh mục thành công!');\r\n    } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n  };\r\n\r\n  const handleDeleteCategory = async (id: string) => {\r\n    // Prevent deleting a category that is used by products\r\n    const inUse = localProducts.some(p => p.category === id);\r\n    if (inUse) {\r\n      showError('Không thể xóa danh mục đang được sử dụng bởi sản phẩm.');\r\n      setShowDeleteConfirm(false);\r\n      setDeleteId(null);\r\n      return;\r\n    }\r\n    try {\r\n      const headers: any = { 'Content-Type': 'application/json' };\r\n      if (authToken) headers.Authorization = `Bearer ${authToken}`;\r\n      const res = await fetch(`${API_BASE}/api/categories/${encodeURIComponent(id)}`, { method: 'DELETE', headers });\r\n      if (!res.ok) { const err = await res.json().catch(() => ({})); showError(err.error || 'Xóa danh mục thất bại'); return; }\r\n      const updated = localCategories.filter(c => c.id !== id);\r\n      setLocalCategories(updated);\r\n      try { addAudit({ action: 'delete', target: 'category', targetId: id, before: null, after: null, note: 'Xóa danh mục' }); } catch (e) {}\r\n      try { onUpdateCategories(updated); } catch (e) {}\r\n      setShowDeleteConfirm(false);\r\n      setDeleteId(null);\r\n      showSuccess('Đã xóa danh mục thành công!');\r\n    } catch (e) { console.error(e); showError('Không thể kết nối tới server'); }\r\n  };\r\n\r\n  const handleTabChange = (tab: TabType) => {\r\n    setActiveTab(tab);\r\n    resetForms();\r\n  };\r\n\r\n  const confirmDelete = (id: number | string) => {\r\n    setDeleteId(id);\r\n    setShowDeleteConfirm(true);\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    if (!isAdmin()) { showError('Bạn không có quyền xóa mục.'); setShowDeleteConfirm(false); setDeleteId(null); return; }\r\n    if (deleteId === null) return;\r\n\r\n    switch (activeTab) {\r\n      case 'products':\r\n        handleDeleteProduct(deleteId as number);\r\n        break;\r\n      case 'toppings':\r\n        handleDeleteTopping(deleteId as number);\r\n        break;\r\n      case 'sizes':\r\n        handleDeleteSize(deleteId as number);\r\n        break;\r\n      case 'categories':\r\n        handleDeleteCategory(deleteId as string);\r\n        break;\r\n    }\r\n  };\r\n\r\n  return (\r\n    \u003cdiv className=\"min-h-screen bg-stone-50\">\r\n      {/* Error message */}\r\n      {errorMessage && (\r\n        \u003cdiv className=\"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 bg-red-600 text-white px-6 py-3 rounded-lg shadow-lg\">{errorMessage}\u003c/div>\r\n      )}\r\n\r\n      {/* Non-admin notice */}\r\n      {!isAdmin() && (\r\n        \u003cdiv className=\"fixed top-20 left-1/2 transform -translate-x-1/2 z-40 bg-yellow-100 text-yellow-800 px-4 py-2 rounded shadow-md\">\r\n          Một số chức năng quản lý chỉ dành cho admin. Bạn không có quyền chỉnh sửa.\r\n        \u003c/div>\r\n      )}\r\n\r\n      {/* Header */}\r\n      \u003cdiv className=\"bg-white shadow-md sticky top-0 z-20\">\r\n        \u003cdiv className=\"container mx-auto px-4 py-4 max-w-7xl\">\r\n          \u003cdiv className=\"flex items-center justify-between\">\r\n            \u003cdiv className=\"flex items-center space-x-4\">\r\n              \u003cbutton\r\n                onClick={onBack}\r\n                className=\"p-2 rounded-full hover:bg-stone-100 transition-colors\"\r\n              >\r\n                \u003cArrowLeftIcon className=\"w-6 h-6 text-stone-600\" />\r\n              \u003c/button>\r\n              \u003cdiv>\r\n                \u003ch1 className=\"text-2xl font-bold text-stone-800\">Quản Lý Admin\u003c/h1>\r\n                \u003cp className=\"text-sm text-stone-500\">Quản lý sản phẩm, topping và cài đặt\u003c/p>\r\n              \u003c/div>\r\n            \u003c/div>\r\n          \u003c/div>\r\n\r\n          {/* Tabs */}\r\n          \u003cdiv className=\"mt-4 flex space-x-2 overflow-x-auto\">\r\n            \u003cbutton\r\n              onClick={() => handleTabChange('products')}\r\n              className={`px-4 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 whitespace-nowrap ${\r\n                activeTab === 'products'\r\n                  ? 'bg-amber-500 text-white'\r\n                  : 'bg-stone-100 text-stone-600 hover:bg-stone-200'\r\n              }`}\r\n            >\r\n              \u003cPackageIcon className=\"w-5 h-5\" />\r\n              \u003cspan>Sản Phẩm ({localProducts.length})\u003c/span>\r\n            \u003c/button>\r\n            \u003cbutton\r\n              onClick={() => handleTabChange('toppings')}\r\n              className={`px-4 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 whitespace-nowrap ${\r\n                activeTab === 'toppings'\r\n                  ? 'bg-amber-500 text-white'\r\n                  : 'bg-stone-100 text-stone-600 hover:bg-stone-200'\r\n              }`}\r\n            >\r\n              \u003cToppingIcon className=\"w-5 h-5\" />\r\n              \u003cspan>Topping ({localToppings.length})\u003c/span>\r\n            \u003c/button>\r\n            \u003cbutton\r\n              onClick={() => handleTabChange('sizes')}\r\n              className={`px-4 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 whitespace-nowrap ${\r\n                activeTab === 'sizes'\r\n                  ? 'bg-amber-500 text-white'\r\n                  : 'bg-stone-100 text-stone-600 hover:bg-stone-200'\r\n              }`}\r\n            >\r\n              \u003cSizeIcon className=\"w-5 h-5\" />\r\n              \u003cspan>Size ({localSizes.length})\u003c/span>\r\n            \u003c/button>\r\n            \u003cbutton\r\n              onClick={() => handleTabChange('categories')}\r\n              className={`px-4 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 whitespace-nowrap ${\r\n                activeTab === 'categories'\r\n                  ? 'bg-amber-500 text-white'\r\n                  : 'bg-stone-100 text-stone-600 hover:bg-stone-200'\r\n              }`}\r\n            >\r\n              \u003cTagIcon className=\"w-5 h-5\" />\r\n              \u003cspan>Danh Mục ({localCategories.length})\u003c/span>\r\n            \u003c/button>\r\n            \u003cbutton\r\n              onClick={() => handleTabChange('audit')}\r\n              className={`px-4 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 whitespace-nowrap ${\r\n                activeTab === 'audit'\r\n                  ? 'bg-amber-500 text-white'\r\n                  : 'bg-stone-100 text-stone-600 hover:bg-stone-200'\r\n              }`}\r\n            >\r\n              \u003cWarningIcon className=\"w-5 h-5\" />\r\n              \u003cspan>Nhật Ký ({audits.length})\u003c/span>\r\n            \u003c/button>\r\n          \u003c/div>\r\n        \u003c/div>\r\n      \u003c/div>\r\n\r\n      {/* Success Message */}\r\n      {successMessage && (\r\n        \u003cdiv className=\"fixed top-20 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg animate-fade-in-pop\">\r\n          {successMessage}\r\n        \u003c/div>\r\n      )}\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      {showDeleteConfirm && (\r\n        \u003cdiv className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\r\n          \u003cdiv className=\"bg-white rounded-xl p-6 max-w-md w-full animate-fade-in-pop\">\r\n            \u003cdiv className=\"flex items-center space-x-3 mb-4\">\r\n              \u003cdiv className=\"bg-red-100 p-3 rounded-full\">\r\n                \u003cWarningIcon className=\"w-6 h-6 text-red-600\" />\r\n              \u003c/div>\r\n              \u003ch3 className=\"text-xl font-bold text-stone-800\">Xác Nhận Xóa\u003c/h3>\r\n            \u003c/div>\r\n            \u003cp className=\"text-stone-600 mb-6\">\r\n              Bạn có chắc chắn muốn xóa mục này? Hành động này không thể hoàn tác.\r\n            \u003c/p>\r\n            \u003cdiv className=\"flex space-x-3\">\r\n              \u003cbutton\r\n                onClick={() => {\r\n                  setShowDeleteConfirm(false);\r\n                  setDeleteId(null);\r\n                }}\r\n                className=\"flex-1 px-4 py-2 bg-stone-200 text-stone-700 rounded-lg font-medium hover:bg-stone-300 transition-colors\"\r\n              >\r\n                Hủy\r\n              \u003c/button>\r\n              \u003cbutton\r\n                onClick={handleDelete}\r\n                className=\"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors\"\r\n              >\r\n                Xóa\r\n              \u003c/button>\r\n            \u003c/div>\r\n          \u003c/div>\r\n        \u003c/div>\r\n      )}\r\n\r\n      {/* Content */}\r\n      \u003cdiv className=\"container mx-auto px-4 py-8 max-w-7xl\">\r\n        {/* Audit Tab */}\r\n        {activeTab === 'audit' && (\r\n          \u003cdiv className=\"space-y-6\">\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6 flex items-center justify-between\">\r\n              \u003ch2 className=\"text-xl font-bold\">Nhật Ký Thao Tác (Audit Log)\u003c/h2>\r\n              \u003cdiv className=\"flex items-center space-x-3\">\r\n                \u003cbutton\r\n                  onClick={() => { clearAudits(); showSuccess('Đã xóa nhật ký'); }}\r\n                  className=\"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors\"\r\n                >\r\n                  Xóa tất cả\r\n                \u003c/button>\r\n              \u003c/div>\r\n            \u003c/div>\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              {audits.length === 0 ? (\r\n                \u003cp className=\"text-center text-stone-500 py-8\">Chưa có bản ghi\u003c/p>\r\n              ) : (\r\n                \u003cdiv className=\"space-y-3\">\r\n                  {audits.slice(0, 200).map((entry) => (\r\n                    \u003cdiv key={entry.id} className=\"p-3 border border-stone-100 rounded-lg\">\r\n                      \u003cdiv className=\"flex justify-between items-start\">\r\n                        \u003cdiv>\r\n                          \u003cp className=\"font-semibold\">{entry.action.toUpperCase()} • {entry.target} #{entry.targetId}\u003c/p>\r\n                          \u003cp className=\"text-xs text-stone-500\">{new Date(entry.timestamp).toLocaleString('vi-VN')} — {entry.user || '—'} ({entry.role || '—'})\u003c/p>\r\n                          {entry.note && \u003cp className=\"text-sm text-stone-600 mt-1\">{entry.note}\u003c/p>}\r\n                        \u003c/div>\r\n                        \u003cdetails className=\"text-xs text-stone-500 max-w-lg\">\r\n                          \u003csummary className=\"cursor-pointer\">Chi tiết\u003c/summary>\r\n                          \u003cpre className=\"text-xs mt-2 overflow-auto max-h-40 bg-stone-50 p-2 rounded\">{JSON.stringify({ before: entry.before, after: entry.after }, null, 2)}\u003c/pre>\r\n                        \u003c/details>\r\n                      \u003c/div>\r\n                    \u003c/div>\r\n                  ))}\r\n                \u003c/div>\r\n              )}\r\n            \u003c/div>\r\n          \u003c/div>\r\n        )}\r\n\r\n        {/* Products Tab */}\r\n        {activeTab === 'products' && (\r\n          \u003cdiv className=\"space-y-6\">\r\n            {/* Product Form */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch2 className=\"text-xl font-bold text-stone-800 mb-4 flex items-center space-x-2\">\r\n                \u003cPlusIcon className=\"w-6 h-6\" />\r\n                \u003cspan>{isEditing ? 'Chỉnh Sửa Sản Phẩm' : 'Thêm Sản Phẩm Mới'}\u003c/span>\r\n              \u003c/h2>\r\n              \u003cdiv className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Tên Sản Phẩm\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"text\"\r\n                    value={productForm.name}\r\n                    onChange={(e) => setProductForm({ ...productForm, name: e.target.value })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"VD: Trà Sữa Truyền Thống\"\r\n                  />\r\n                  {productErrors.name && \u003cp className=\"text-red-500 text-sm mt-1\">{productErrors.name}\u003c/p>}\r\n                \u003c/div>\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Giá (VNĐ)\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"number\"\r\n                    value={productForm.price}\r\n                    onChange={(e) => setProductForm({ ...productForm, price: Number(e.target.value) })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"20000\"\r\n                  />\r\n                  {productErrors.price && \u003cp className=\"text-red-500 text-sm mt-1\">{productErrors.price}\u003c/p>}\r\n                \u003c/div>\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    URL Hình Ảnh\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"text\"\r\n                    value={productForm.image}\r\n                    onChange={(e) => setProductForm({ ...productForm, image: e.target.value })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"https://example.com/image.jpg\"\r\n                  />\r\n                  {productErrors.image && \u003cp className=\"text-red-500 text-sm mt-1\">{productErrors.image}\u003c/p>}\r\n                \u003c/div>\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Danh Mục\r\n                  \u003c/label>\r\n                  \u003cselect\r\n                    value={productForm.category}\r\n                    onChange={(e) => setProductForm({ ...productForm, category: e.target.value })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                  >\r\n                    {localCategories.map((cat) => (\r\n                      \u003coption key={cat.id} value={cat.id}>\r\n                        {cat.name}\r\n                      \u003c/option>\r\n                    ))}\r\n                  \u003c/select>\r\n                  {productErrors.category && \u003cp className=\"text-red-500 text-sm mt-1\">{productErrors.category}\u003c/p>}\r\n                \u003c/div>\r\n              \u003c/div>\r\n              \u003cdiv className=\"mt-4 flex space-x-3\">\r\n                {isEditing ? (\r\n                  \u003c>\r\n                    \u003cbutton\r\n                      onClick={handleUpdateProduct}\r\n                      disabled={!productForm.name || !productForm.price || !isAdmin()}\r\n                      title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                      className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                    >\r\n                      \u003cSaveIcon className=\"w-5 h-5\" />\r\n                      \u003cspan>Cập Nhật\u003c/span>\r\n                    \u003c/button>\r\n                    \u003cbutton\r\n                      onClick={resetForms}\r\n                      className=\"px-6 py-3 bg-stone-200 text-stone-700 rounded-lg font-medium hover:bg-stone-300 transition-colors\"\r\n                    >\r\n                      Hủy\r\n                    \u003c/button>\r\n                  \u003c/>\r\n                ) : (\r\n                  \u003cbutton\r\n                    onClick={handleAddProduct}\r\n                    disabled={!productForm.name || !productForm.price || !isAdmin()}\r\n                    title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                    className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                  >\r\n                    \u003cPlusIcon className=\"w-5 h-5\" />\r\n                    \u003cspan>Thêm Sản Phẩm\u003c/span>\r\n                  \u003c/button>\r\n                )}\r\n              \u003c/div>\r\n            \u003c/div>\r\n\r\n            {/* Products List */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch3 className=\"text-lg font-bold text-stone-800 mb-4\">Danh Sách Sản Phẩm\u003c/h3>\r\n              \u003cdiv className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                {products.map((product) => (\r\n                  \u003cdiv\r\n                    key={product.id}\r\n                    className=\"border border-stone-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow\"\r\n                  >\r\n                    \u003cimg\r\n                      src={product.image}\r\n                      alt={product.name}\r\n                      className=\"w-full h-40 object-cover bg-stone-100\"\r\n                    />\r\n                    \u003cdiv className=\"p-4\">\r\n                      \u003ch4 className=\"font-bold text-stone-800\">{product.name}\u003c/h4>\r\n                      \u003cp className=\"text-amber-600 font-semibold mt-1\">{formatVND(product.price)}\u003c/p>\r\n                      \u003cp className=\"text-sm text-stone-500 mt-1\">\r\n                        {localCategories.find(c => c.id === product.category)?.name || product.category}\r\n                      \u003c/p>\r\n                      \u003cdiv className=\"flex space-x-2 mt-3\">\r\n                        \u003cbutton\r\n                          onClick={() => handleEditProduct(product)}\r\n                          disabled={!isAdmin()}\r\n                          title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                          className={`flex-1 px-3 py-2 ${isAdmin() ? 'bg-blue-500 text-white hover:bg-blue-600' : 'bg-stone-200 text-stone-500 cursor-not-allowed'} rounded-lg transition-colors flex items-center justify-center space-x-1`}\r\n                        >\r\n                          \u003cEditIcon className=\"w-4 h-4\" />\r\n                          \u003cspan>Sửa\u003c/span>\r\n                        \u003c/button>\r\n                        \u003cbutton\r\n                          onClick={() => confirmDelete(product.id)}\r\n                          disabled={!isAdmin()}\r\n                          title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                          className={`flex-1 px-3 py-2 ${isAdmin() ? 'bg-red-500 text-white hover:bg-red-600' : 'bg-stone-200 text-stone-500 cursor-not-allowed'} rounded-lg transition-colors flex items-center justify-center space-x-1`}\r\n                        >\r\n                          \u003cTrashIcon className=\"w-4 h-4\" />\r\n                          \u003cspan>Xóa\u003c/span>\r\n                        \u003c/button>\r\n                      \u003c/div>\r\n                    \u003c/div>\r\n                  \u003c/div>\r\n                ))}\r\n              \u003c/div>\r\n            \u003c/div>\r\n          \u003c/div>\r\n        )}\r\n\r\n        {/* Toppings Tab */}\r\n        {activeTab === 'toppings' && (\r\n          \u003cdiv className=\"space-y-6\">\r\n            {/* Topping Form */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch2 className=\"text-xl font-bold text-stone-800 mb-4 flex items-center space-x-2\">\r\n                \u003cPlusIcon className=\"w-6 h-6\" />\r\n                \u003cspan>{isEditing ? 'Chỉnh Sửa Topping' : 'Thêm Topping Mới'}\u003c/span>\r\n              \u003c/h2>\r\n              \u003cdiv className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Tên Topping\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"text\"\r\n                    value={toppingForm.name}\r\n                    onChange={(e) => setToppingForm({ ...toppingForm, name: e.target.value })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"VD: Trân Châu Đen\"\r\n                  />\r\n                  {toppingErrors.name && \u003cp className=\"text-red-500 text-sm mt-1\">{toppingErrors.name}\u003c/p>}\r\n                \u003c/div>\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Giá (VNĐ)\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"number\"\r\n                    value={toppingForm.price}\r\n                    onChange={(e) => setToppingForm({ ...toppingForm, price: Number(e.target.value) })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"5000\"\r\n                  />\r\n                  {toppingErrors.price && \u003cp className=\"text-red-500 text-sm mt-1\">{toppingErrors.price}\u003c/p>}\r\n                \u003c/div>\r\n              \u003c/div>\r\n              \u003cdiv className=\"mt-4 flex space-x-3\">\r\n                {isEditing ? (\r\n                  \u003c>\r\n                    \u003cbutton\r\n                      onClick={handleUpdateTopping}\r\n                      disabled={!toppingForm.name || !toppingForm.price || !isAdmin()}\r\n                      title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                      className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                    >\r\n                      \u003cSaveIcon className=\"w-5 h-5\" />\r\n                      \u003cspan>Cập Nhật\u003c/span>\r\n                    \u003c/button>\r\n                    \u003cbutton\r\n                      onClick={resetForms}\r\n                      className=\"px-6 py-3 bg-stone-200 text-stone-700 rounded-lg font-medium hover:bg-stone-300 transition-colors\"\r\n                    >\r\n                      Hủy\r\n                    \u003c/button>\r\n                  \u003c/>\r\n                ) : (\r\n                  \u003cbutton\r\n                    onClick={handleAddTopping}\r\n                    disabled={!toppingForm.name || !toppingForm.price || !isAdmin()}\r\n                    title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                    className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                  >\r\n                    \u003cPlusIcon className=\"w-5 h-5\" />\r\n                    \u003cspan>Thêm Topping\u003c/span>\r\n                  \u003c/button>\r\n                )}\r\n              \u003c/div>\r\n            \u003c/div>\r\n\r\n            {/* Toppings List */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch3 className=\"text-lg font-bold text-stone-800 mb-4\">Danh Sách Topping\u003c/h3>\r\n              \u003cdiv className=\"space-y-2\">\r\n                {toppings.map((topping) => (\r\n                  \u003cdiv\r\n                    key={topping.id}\r\n                    className=\"flex items-center justify-between p-4 border border-stone-200 rounded-lg hover:bg-stone-50 transition-colors\"\r\n                  >\r\n                    \u003cdiv>\r\n                      \u003ch4 className=\"font-bold text-stone-800\">{topping.name}\u003c/h4>\r\n                      \u003cp className=\"text-amber-600 font-semibold\">{formatVND(topping.price)}\u003c/p>\r\n                    \u003c/div>\r\n                    \u003cdiv className=\"flex space-x-2\">\r\n                      \u003cbutton\r\n                        onClick={() => handleEditTopping(topping)}\r\n                        disabled={!isAdmin()}\r\n                        title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                        className={`px-3 py-2 ${isAdmin() ? 'bg-blue-500 text-white hover:bg-blue-600' : 'bg-stone-200 text-stone-500 cursor-not-allowed'} rounded-lg transition-colors flex items-center space-x-1`}\r\n                      >\r\n                        \u003cEditIcon className=\"w-4 h-4\" />\r\n                        \u003cspan>Sửa\u003c/span>\r\n                      \u003c/button>\r\n                      \u003cbutton\r\n                        onClick={() => confirmDelete(topping.id)}\r\n                        disabled={!isAdmin()}\r\n                        title={!isAdmin() ? 'Chỉ admin mới có quyền' : undefined}\r\n                        className={`px-3 py-2 ${isAdmin() ? 'bg-red-500 text-white hover:bg-red-600' : 'bg-stone-200 text-stone-500 cursor-not-allowed'} rounded-lg transition-colors flex items-center space-x-1`}\r\n                      >\r\n                        \u003cTrashIcon className=\"w-4 h-4\" />\r\n                        \u003cspan>Xóa\u003c/span>\r\n                      \u003c/button>\r\n                    \u003c/div>\r\n                  \u003c/div>\r\n                ))}\r\n              \u003c/div>\r\n            \u003c/div>\r\n          \u003c/div>\r\n        )}\r\n\r\n        {/* Sizes Tab */}\r\n        {activeTab === 'sizes' && (\r\n          \u003cdiv className=\"space-y-6\">\r\n            {/* Size Form */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch2 className=\"text-xl font-bold text-stone-800 mb-4 flex items-center space-x-2\">\r\n                \u003cPlusIcon className=\"w-6 h-6\" />\r\n                \u003cspan>{isEditing ? 'Chỉnh Sửa Size' : 'Thêm Size Mới'}\u003c/span>\r\n              \u003c/h2>\r\n              \u003cdiv className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Tên Size\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"text\"\r\n                    value={sizeForm.name}\r\n                    onChange={(e) => setSizeForm({ ...sizeForm, name: e.target.value })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"VD: Size L\"\r\n                  />\r\n                  {sizeErrors.name && \u003cp className=\"text-red-500 text-sm mt-1\">{sizeErrors.name}\u003c/p>}\r\n                \u003c/div>\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Giá Thêm (VNĐ)\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"number\"\r\n                    value={sizeForm.priceModifier}\r\n                    onChange={(e) => setSizeForm({ ...sizeForm, priceModifier: Number(e.target.value) })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"5000\"\r\n                  />\r\n                  {sizeErrors.priceModifier && \u003cp className=\"text-red-500 text-sm mt-1\">{sizeErrors.priceModifier}\u003c/p>}\r\n                \u003c/div>\r\n              \u003c/div>\r\n              \u003cdiv className=\"mt-4 flex space-x-3\">\r\n                {isEditing ? (\r\n                  \u003c>\r\n                    \u003cbutton\r\n                      onClick={handleUpdateSize}\r\n                      disabled={!sizeForm.name}\r\n                      className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                    >\r\n                      \u003cSaveIcon className=\"w-5 h-5\" />\r\n                      \u003cspan>Cập Nhật\u003c/span>\r\n                    \u003c/button>\r\n                    \u003cbutton\r\n                      onClick={resetForms}\r\n                      className=\"px-6 py-3 bg-stone-200 text-stone-700 rounded-lg font-medium hover:bg-stone-300 transition-colors\"\r\n                    >\r\n                      Hủy\r\n                    \u003c/button>\r\n                  \u003c/>\r\n                ) : (\r\n                  \u003cbutton\r\n                    onClick={handleAddSize}\r\n                    disabled={!sizeForm.name}\r\n                    className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                  >\r\n                    \u003cPlusIcon className=\"w-5 h-5\" />\r\n                    \u003cspan>Thêm Size\u003c/span>\r\n                  \u003c/button>\r\n                )}\r\n              \u003c/div>\r\n            \u003c/div>\r\n\r\n            {/* Sizes List */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch3 className=\"text-lg font-bold text-stone-800 mb-4\">Danh Sách Size\u003c/h3>\r\n              \u003cdiv className=\"space-y-2\">\r\n                {sizes.map((size) => (\r\n                  \u003cdiv\r\n                    key={size.id}\r\n                    className=\"flex items-center justify-between p-4 border border-stone-200 rounded-lg hover:bg-stone-50 transition-colors\"\r\n                  >\r\n                    \u003cdiv>\r\n                      \u003ch4 className=\"font-bold text-stone-800\">{size.name}\u003c/h4>\r\n                      \u003cp className=\"text-amber-600 font-semibold\">\r\n                        {size.priceModifier > 0 ? `+${formatVND(size.priceModifier)}` : 'Giá gốc'}\r\n                      \u003c/p>\r\n                    \u003c/div>\r\n                    \u003cdiv className=\"flex space-x-2\">\r\n                      \u003cbutton\r\n                        onClick={() => handleEditSize(size)}\r\n                        className=\"px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-1\"\r\n                      >\r\n                        \u003cEditIcon className=\"w-4 h-4\" />\r\n                        \u003cspan>Sửa\u003c/span>\r\n                      \u003c/button>\r\n                      \u003cbutton\r\n                        onClick={() => confirmDelete(size.id)}\r\n                        className=\"px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center space-x-1\"\r\n                      >\r\n                        \u003cTrashIcon className=\"w-4 h-4\" />\r\n                        \u003cspan>Xóa\u003c/span>\r\n                      \u003c/button>\r\n                    \u003c/div>\r\n                  \u003c/div>\r\n                ))}\r\n              \u003c/div>\r\n            \u003c/div>\r\n          \u003c/div>\r\n        )}\r\n\r\n        {/* Categories Tab */}\r\n        {activeTab === 'categories' && (\r\n          \u003cdiv className=\"space-y-6\">\r\n            {/* Category Form */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch2 className=\"text-xl font-bold text-stone-800 mb-4 flex items-center space-x-2\">\r\n                \u003cPlusIcon className=\"w-6 h-6\" />\r\n                \u003cspan>{isEditing ? 'Chỉnh Sửa Danh Mục' : 'Thêm Danh Mục Mới'}\u003c/span>\r\n              \u003c/h2>\r\n              \u003cdiv className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    ID Danh Mục (không dấu, viết thường)\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"text\"\r\n                    value={categoryForm.id}\r\n                    onChange={(e) => setCategoryForm({ ...categoryForm, id: e.target.value })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"VD: milk-tea\"\r\n                    disabled={isEditing}\r\n                  />\r\n                  {categoryErrors.id && \u003cp className=\"text-red-500 text-sm mt-1\">{categoryErrors.id}\u003c/p>}\r\n                \u003c/div>\r\n                \u003cdiv>\r\n                  \u003clabel className=\"block text-sm font-medium text-stone-700 mb-2\">\r\n                    Tên Danh Mục\r\n                  \u003c/label>\r\n                  \u003cinput\r\n                    type=\"text\"\r\n                    value={categoryForm.name}\r\n                    onChange={(e) => setCategoryForm({ ...categoryForm, name: e.target.value })}\r\n                    className=\"w-full px-4 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500\"\r\n                    placeholder=\"VD: Trà Sữa\"\r\n                  />\r\n                  {categoryErrors.name && \u003cp className=\"text-red-500 text-sm mt-1\">{categoryErrors.name}\u003c/p>}\r\n                \u003c/div>\r\n              \u003c/div>\r\n              \u003cdiv className=\"mt-4 flex space-x-3\">\r\n                {isEditing ? (\r\n                  \u003c>\r\n                    \u003cbutton\r\n                      onClick={handleUpdateCategory}\r\n                      disabled={!categoryForm.id || !categoryForm.name}\r\n                      className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                    >\r\n                      \u003cSaveIcon className=\"w-5 h-5\" />\r\n                      \u003cspan>Cập Nhật\u003c/span>\r\n                    \u003c/button>\r\n                    \u003cbutton\r\n                      onClick={resetForms}\r\n                      className=\"px-6 py-3 bg-stone-200 text-stone-700 rounded-lg font-medium hover:bg-stone-300 transition-colors\"\r\n                    >\r\n                      Hủy\r\n                    \u003c/button>\r\n                  \u003c/>\r\n                ) : (\r\n                  \u003cbutton\r\n                    onClick={handleAddCategory}\r\n                    disabled={!categoryForm.id || !categoryForm.name}\r\n                    className=\"flex-1 px-6 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\r\n                  >\r\n                    \u003cPlusIcon className=\"w-5 h-5\" />\r\n                    \u003cspan>Thêm Danh Mục\u003c/span>\r\n                  \u003c/button>\r\n                )}\r\n              \u003c/div>\r\n            \u003c/div>\r\n\r\n            {/* Categories List */}\r\n            \u003cdiv className=\"bg-white rounded-xl shadow-md p-6\">\r\n              \u003ch3 className=\"text-lg font-bold text-stone-800 mb-4\">Danh Sách Danh Mục\u003c/h3>\r\n              \u003cdiv className=\"space-y-2\">\r\n                {categories.map((category) => (\r\n                  \u003cdiv\r\n                    key={category.id}\r\n                    className=\"flex items-center justify-between p-4 border border-stone-200 rounded-lg hover:bg-stone-50 transition-colors\"\r\n                  >\r\n                    \u003cdiv>\r\n                      \u003ch4 className=\"font-bold text-stone-800\">{category.name}\u003c/h4>\r\n                      \u003cp className=\"text-sm text-stone-500\">ID: {category.id}\u003c/p>\r\n                    \u003c/div>\r\n                    \u003cdiv className=\"flex space-x-2\">\r\n                      \u003cbutton\r\n                        onClick={() => handleEditCategory(category)}\r\n                        className=\"px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-1\"\r\n                      >\r\n                        \u003cEditIcon className=\"w-4 h-4\" />\r\n                        \u003cspan>Sửa\u003c/span>\r\n                      \u003c/button>\r\n                      \u003cbutton\r\n                        onClick={() => confirmDelete(category.id)}\r\n                        className=\"px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center space-x-1\"\r\n                      >\r\n                        \u003cTrashIcon className=\"w-4 h-4\" />\r\n                        \u003cspan>Xóa\u003c/span>\r\n                      \u003c/button>\r\n                    \u003c/div>\r\n                  \u003c/div>\r\n                ))}\r\n              \u003c/div>\r\n            \u003c/div>\r\n          \u003c/div>\r\n        )}\r\n      \u003c/div>\r\n    \u003c/div>\r\n  );\r\n};\r\n\r\nexport default AdminPanel;\r\n\r\n","loc":{"line":435,"column":18,"index":19601}}
              try {
                const { ErrorOverlay } = await import("/@vite/client")
                document.body.appendChild(new ErrorOverlay(error))
              } catch {
                const h = (tag, text) => {
                  const el = document.createElement(tag)
                  el.textContent = text
                  return el
                }
                document.body.appendChild(h('h1', 'Internal Server Error'))
                document.body.appendChild(h('h2', error.message))
                document.body.appendChild(h('pre', error.stack))
                document.body.appendChild(h('p', '(Error overlay failed to load)'))
              }
            </script>
          </head>
          <body>
          </body>
        </html>
      